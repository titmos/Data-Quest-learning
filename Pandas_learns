import pandas as pd
f500 = pd.read_csv('f500.csv', index_col=0) #using the pandas CSV reader
f500.index.name = None

f500_type = type(f500) 
f500_shape = f500.shape #displays the shape of the dataset in row by column
print(f500_type)
print(f500_shape)

print(f500.head(3)) # would display the header and first 3 rows in the dataset
print(f500.tail(3)) # would display the last 3 rows in the dataset
f500_top_6 = f500.head(6)
f500_bottom_8 = f500.tail(8)


#overview of all the dtypes used in our DataFrame, along with its shape and other information, we can use the DataFrame.info() method
f500.info()


#There are two types of labels in pandas: Row Labels and Column Labels.
# df.loc[row_label, column_label]
# Select a Single Column
# dataFra.loc[:, "col_name"]
# we can also use f500_selection["rank"]
industries = f500["industry"]
industries_type = type(industries)
print(industries, '\n')
print(industries_type)


#Selecting Columns from a DataFrame by Label 
#this is for a single selection
countries = f500["country"]
#this works for multiple columns selection
revenues_years = f500[["revenues", "years_on_global_500_list"]]

#printing slices in a range, We will have to do the full specification using .loc
ceo_to_sector = f500.loc[:,"ceo" : "sector"]



"""Select the country column from f500 and save it to the variable countries.
Use the Series.value_counts() method to get the value counts for each unique non-null value in countries and save the results in the variable country_counts.
Print the variable country_counts to determine which country has the most companies on the Fortune 500 list and save that country's name as a string in the variable top_country."""

#Sample application of  the value_counts method on series data
countries = f500["country"]
country_counts = countries.value_counts()
print(country_counts)
top_country = 'USA'

hq_locations =f500["hq_location"]
hql_counts = hq_locations.value_counts()
print(hql_counts)
top_hq_city ='Beijing, China'

#Sample application of  the value_counts method on dataFrames

sectors_industries = f500[["sector", "industry"]]
print(type(sectors_industries))
si_value_counts = sectors_industries.value_counts()
print(si_value_counts)

#Series.describe() method tells us how many non-null values are contained in the series
#along with the mean, minimum, maximum

rank = f500["rank"]
rank_desc = rank.describe()
print(rank_desc)
prev_rank = f500["previous_rank"]
prev_rank_desc = prev_rank.describe()
print(prev_rank_desc)

#Method Chaining
#a way to combine multiple methods together in a single line.
prev_rank = f500["previous_rank"]
zero_previous_rank = prev_rank.value_counts().loc[0]

#using method chaining 
zero_using_chaining = f500["previous_rank"].value_counts().loc[0]


#Dataframe Exploration Methods
medians = f500[["revenues", "profits"]].median(axis=0)
# we could also use .median(axis="index")
print(medians)
#f500.info()
numeric_only = f500[["rank", "revenues", "revenue_change", "profits", "assets", "profit_change", "previous_rank", "years_on_global_500_list", "employees", "total_stockholder_equity"]]
max_f5001 = numeric_only.max(axis = 0)
max_f500 = f500.max(numeric_only = True)

